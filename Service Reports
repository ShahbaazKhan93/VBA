Sub AutomateServiceReport()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim rng As Range
    Dim pvtCache As PivotCache
    Dim pvt As PivotTable
    
    ' Set the active worksheet
    Set ws = ActiveSheet
    
    ' Find the last row of data
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Format the data as a table
    Set rng = ws.Range("A1:G" & lastRow)
    ws.ListObjects.Add(xlSrcRange, rng, , xlYes).Name = "ServiceData"
    
    ' Add total row to the table
    ws.ListObjects("ServiceData").ShowTotals = True
    
    ' Create a new sheet for the summary report
    Sheets.Add.Name = "Summary Report"
    Set ws = Sheets("Summary Report")
    
    ' Create Pivot Table
    Set pvtCache = ThisWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:="ServiceData")
    Set pvt = pvtCache.CreatePivotTable(TableDestination:=ws.Cells(3, 1), TableName:="ServiceSummary")
    
    ' Add fields to the Pivot Table
    With pvt
        .PivotFields("Service Category").Orientation = xlRowField
        .PivotFields("Mechanic").Orientation = xlColumnField
        .AddDataField .PivotFields("Service Time (hrs)"), "Total Hours", xlSum
        .AddDataField .PivotFields("Service Cost ($)"), "Total Cost", xlSum
    End With
    
    ' Format Pivot Table
    ws.PivotTables("ServiceSummary").ShowValuesRow = True
    ws.PivotTables("ServiceSummary").PivotFields("Total Hours").NumberFormat = "0.00"
    ws.PivotTables("ServiceSummary").PivotFields("Total Cost").NumberFormat = "$#,##0.00"
    
    ' Add title
    ws.Cells(1, 1).Value = "Service Summary Report"
    ws.Cells(1, 1).Font.Size = 14
    ws.Cells(1, 1).Font.Bold = True
    
    ' Calculate and display some statistics
    Dim dataWs As Worksheet
    Set dataWs = ThisWorkbook.Sheets("Sheet1") ' Assuming the original data is on Sheet1
    
    ws.Cells(1, 6).Value = "Statistics"
    ws.Cells(1, 6).Font.Bold = True
    ws.Cells(2, 6).Value = "Total Services:"
    ws.Cells(2, 7).Value = Application.CountA(dataWs.Range("A2:A" & lastRow))
    ws.Cells(3, 6).Value = "Average Service Time:"
    ws.Cells(3, 7).Value = Application.Average(dataWs.Range("F2:F" & lastRow))
    ws.Cells(3, 7).NumberFormat = "0.00"
    ws.Cells(4, 6).Value = "Total Revenue:"
    ws.Cells(4, 7).Value = Application.Sum(dataWs.Range("G2:G" & lastRow))
    ws.Cells(4, 7).NumberFormat = "$#,##0.00"
    
    ' Auto-fit columns
    ws.Cells.EntireColumn.AutoFit
    
    MsgBox "Report generated successfully!", vbInformation
End Sub	
